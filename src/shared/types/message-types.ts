/**
 * Message Types - WebSocket Protocol Messages
 * Contains all request/response types for Gateway <-> Browser communication
 */

import type {
  WorldInfo,
  CompanyInfo,
  MapData,
  ChatUser,
  BuildingFocusInfo,
  BuildingCategory,
  BuildingInfo,
  SurfaceData,
  FacilityDimensions,
  BuildingDetailsResponse,
  SearchMenuCategory,
  TownInfo,
  TycoonProfile,
  TycoonProfileFull,
  RankingCategory,
  RankingEntry,
  SurfaceType,
  MailFolder,
  MailMessageHeader,
  MailMessageFull,
  CurriculumData,
  BankAccountData,
  BankActionType,
  BankActionResult,
  ProfitLossData,
  CompaniesData,
  AutoConnectionsData,
  AutoConnectionActionType,
  PolicyData,
} from './domain-types';

import type { RdoVerb, RdoAction } from './protocol-types';

// =============================================================================
// MESSAGE TYPE ENUM
// =============================================================================

export enum WsMessageType {
  // Client -> Gateway (Requests)
  REQ_CONNECT_DIRECTORY = 'REQ_CONNECT_DIRECTORY',
  REQ_LOGIN_WORLD = 'REQ_LOGIN_WORLD',
  REQ_RDO_DIRECT = 'REQ_RDO_DIRECT',
  REQ_MAP_LOAD = 'REQ_MAP_LOAD',
  REQ_SELECT_COMPANY = 'REQ_SELECT_COMPANY',
  REQ_SWITCH_COMPANY = 'REQ_SWITCH_COMPANY',
  REQ_MANAGE_CONSTRUCTION = 'REQ_MANAGE_CONSTRUCTION',

  // Gateway -> Client (Responses)
  RESP_CONNECT_SUCCESS = 'RESP_CONNECT_SUCCESS',
  RESP_LOGIN_SUCCESS = 'RESP_LOGIN_SUCCESS',
  RESP_RDO_RESULT = 'RESP_RDO_RESULT',
  RESP_ERROR = 'RESP_ERROR',
  RESP_MAP_DATA = 'RESP_MAP_DATA',
  RESP_CONSTRUCTION_SUCCESS = 'RESP_CONSTRUCTION_SUCCESS',

  // Gateway -> Client (Async Events / Pushes)
  EVENT_CHAT_MSG = 'EVENT_CHAT_MSG',
  EVENT_MAP_DATA = 'EVENT_MAP_DATA',
  EVENT_TYCOON_UPDATE = 'EVENT_TYCOON_UPDATE',
  EVENT_RDO_PUSH = 'EVENT_RDO_PUSH',

  // Chat functionality
  REQ_CHAT_GET_USERS = 'REQ_CHAT_GET_USERS',
  REQ_CHAT_GET_CHANNELS = 'REQ_CHAT_GET_CHANNELS',
  REQ_CHAT_GET_CHANNEL_INFO = 'REQ_CHAT_GET_CHANNEL_INFO',
  REQ_CHAT_JOIN_CHANNEL = 'REQ_CHAT_JOIN_CHANNEL',
  REQ_CHAT_SEND_MESSAGE = 'REQ_CHAT_SEND_MESSAGE',
  REQ_CHAT_TYPING_STATUS = 'REQ_CHAT_TYPING_STATUS',

  RESP_CHAT_USER_LIST = 'RESP_CHAT_USER_LIST',
  RESP_CHAT_CHANNEL_LIST = 'RESP_CHAT_CHANNEL_LIST',
  RESP_CHAT_CHANNEL_INFO = 'RESP_CHAT_CHANNEL_INFO',
  RESP_CHAT_SUCCESS = 'RESP_CHAT_SUCCESS',

  EVENT_CHAT_USER_TYPING = 'EVENT_CHAT_USER_TYPING',
  EVENT_CHAT_CHANNEL_CHANGE = 'EVENT_CHAT_CHANNEL_CHANGE',
  EVENT_CHAT_USER_LIST_CHANGE = 'EVENT_CHAT_USER_LIST_CHANGE',

  REQ_BUILDING_FOCUS = 'REQ_BUILDING_FOCUS',
  REQ_BUILDING_UNFOCUS = 'REQ_BUILDING_UNFOCUS',
  RESP_BUILDING_FOCUS = 'RESP_BUILDING_FOCUS',
  EVENT_BUILDING_REFRESH = 'EVENT_BUILDING_REFRESH',

  // Building Construction
  REQ_GET_BUILDING_CATEGORIES = 'REQ_GET_BUILDING_CATEGORIES',
  REQ_GET_BUILDING_FACILITIES = 'REQ_GET_BUILDING_FACILITIES',
  REQ_PLACE_BUILDING = 'REQ_PLACE_BUILDING',
  REQ_GET_SURFACE = 'REQ_GET_SURFACE',
  REQ_GET_ALL_FACILITY_DIMENSIONS = 'REQ_GET_ALL_FACILITY_DIMENSIONS',

  RESP_BUILDING_CATEGORIES = 'RESP_BUILDING_CATEGORIES',
  RESP_BUILDING_FACILITIES = 'RESP_BUILDING_FACILITIES',
  RESP_BUILDING_PLACED = 'RESP_BUILDING_PLACED',
  RESP_SURFACE_DATA = 'RESP_SURFACE_DATA',
  RESP_ALL_FACILITY_DIMENSIONS = 'RESP_ALL_FACILITY_DIMENSIONS',

  // Building Details
  REQ_BUILDING_DETAILS = 'REQ_BUILDING_DETAILS',
  RESP_BUILDING_DETAILS = 'RESP_BUILDING_DETAILS',
  REQ_BUILDING_SET_PROPERTY = 'REQ_BUILDING_SET_PROPERTY',
  RESP_BUILDING_SET_PROPERTY = 'RESP_BUILDING_SET_PROPERTY',

  // Building Upgrades
  REQ_BUILDING_UPGRADE = 'REQ_BUILDING_UPGRADE',
  RESP_BUILDING_UPGRADE = 'RESP_BUILDING_UPGRADE',

  // Building Rename
  REQ_RENAME_FACILITY = 'REQ_RENAME_FACILITY',
  RESP_RENAME_FACILITY = 'RESP_RENAME_FACILITY',

  // Building Deletion
  REQ_DELETE_FACILITY = 'REQ_DELETE_FACILITY',
  RESP_DELETE_FACILITY = 'RESP_DELETE_FACILITY',

  // Road Building
  REQ_BUILD_ROAD = 'REQ_BUILD_ROAD',
  RESP_BUILD_ROAD = 'RESP_BUILD_ROAD',
  REQ_GET_ROAD_COST = 'REQ_GET_ROAD_COST',
  RESP_GET_ROAD_COST = 'RESP_GET_ROAD_COST',

  // Search Menu / Directory
  REQ_SEARCH_MENU_HOME = 'REQ_SEARCH_MENU_HOME',
  REQ_SEARCH_MENU_TOWNS = 'REQ_SEARCH_MENU_TOWNS',
  REQ_SEARCH_MENU_TYCOON_PROFILE = 'REQ_SEARCH_MENU_TYCOON_PROFILE',
  REQ_SEARCH_MENU_PEOPLE = 'REQ_SEARCH_MENU_PEOPLE',
  REQ_SEARCH_MENU_PEOPLE_SEARCH = 'REQ_SEARCH_MENU_PEOPLE_SEARCH',
  REQ_SEARCH_MENU_RANKINGS = 'REQ_SEARCH_MENU_RANKINGS',
  REQ_SEARCH_MENU_RANKING_DETAIL = 'REQ_SEARCH_MENU_RANKING_DETAIL',
  REQ_SEARCH_MENU_BANKS = 'REQ_SEARCH_MENU_BANKS',

  RESP_SEARCH_MENU_HOME = 'RESP_SEARCH_MENU_HOME',
  RESP_SEARCH_MENU_TOWNS = 'RESP_SEARCH_MENU_TOWNS',
  RESP_SEARCH_MENU_TYCOON_PROFILE = 'RESP_SEARCH_MENU_TYCOON_PROFILE',
  RESP_SEARCH_MENU_PEOPLE = 'RESP_SEARCH_MENU_PEOPLE',
  RESP_SEARCH_MENU_PEOPLE_SEARCH = 'RESP_SEARCH_MENU_PEOPLE_SEARCH',
  RESP_SEARCH_MENU_RANKINGS = 'RESP_SEARCH_MENU_RANKINGS',
  RESP_SEARCH_MENU_RANKING_DETAIL = 'RESP_SEARCH_MENU_RANKING_DETAIL',
  RESP_SEARCH_MENU_BANKS = 'RESP_SEARCH_MENU_BANKS',

  // Logout
  REQ_LOGOUT = 'REQ_LOGOUT',
  RESP_LOGOUT = 'RESP_LOGOUT',

  // Mail
  REQ_MAIL_CONNECT = 'REQ_MAIL_CONNECT',
  REQ_MAIL_GET_FOLDER = 'REQ_MAIL_GET_FOLDER',
  REQ_MAIL_READ_MESSAGE = 'REQ_MAIL_READ_MESSAGE',
  REQ_MAIL_COMPOSE = 'REQ_MAIL_COMPOSE',
  REQ_MAIL_DELETE = 'REQ_MAIL_DELETE',
  REQ_MAIL_GET_UNREAD_COUNT = 'REQ_MAIL_GET_UNREAD_COUNT',
  REQ_MAIL_SAVE_DRAFT = 'REQ_MAIL_SAVE_DRAFT',

  RESP_MAIL_CONNECTED = 'RESP_MAIL_CONNECTED',
  RESP_MAIL_FOLDER = 'RESP_MAIL_FOLDER',
  RESP_MAIL_MESSAGE = 'RESP_MAIL_MESSAGE',
  RESP_MAIL_SENT = 'RESP_MAIL_SENT',
  RESP_MAIL_DELETED = 'RESP_MAIL_DELETED',
  RESP_MAIL_UNREAD_COUNT = 'RESP_MAIL_UNREAD_COUNT',
  RESP_MAIL_DRAFT_SAVED = 'RESP_MAIL_DRAFT_SAVED',

  EVENT_NEW_MAIL = 'EVENT_NEW_MAIL',

  // Profile
  REQ_GET_PROFILE = 'REQ_GET_PROFILE',
  RESP_GET_PROFILE = 'RESP_GET_PROFILE',

  // Profile Tabs
  REQ_PROFILE_CURRICULUM = 'REQ_PROFILE_CURRICULUM',
  RESP_PROFILE_CURRICULUM = 'RESP_PROFILE_CURRICULUM',
  REQ_PROFILE_BANK = 'REQ_PROFILE_BANK',
  RESP_PROFILE_BANK = 'RESP_PROFILE_BANK',
  REQ_PROFILE_BANK_ACTION = 'REQ_PROFILE_BANK_ACTION',
  RESP_PROFILE_BANK_ACTION = 'RESP_PROFILE_BANK_ACTION',
  REQ_PROFILE_PROFITLOSS = 'REQ_PROFILE_PROFITLOSS',
  RESP_PROFILE_PROFITLOSS = 'RESP_PROFILE_PROFITLOSS',
  REQ_PROFILE_COMPANIES = 'REQ_PROFILE_COMPANIES',
  RESP_PROFILE_COMPANIES = 'RESP_PROFILE_COMPANIES',
  REQ_PROFILE_AUTOCONNECTIONS = 'REQ_PROFILE_AUTOCONNECTIONS',
  RESP_PROFILE_AUTOCONNECTIONS = 'RESP_PROFILE_AUTOCONNECTIONS',
  REQ_PROFILE_AUTOCONNECTION_ACTION = 'REQ_PROFILE_AUTOCONNECTION_ACTION',
  RESP_PROFILE_AUTOCONNECTION_ACTION = 'RESP_PROFILE_AUTOCONNECTION_ACTION',
  REQ_PROFILE_POLICY = 'REQ_PROFILE_POLICY',
  RESP_PROFILE_POLICY = 'RESP_PROFILE_POLICY',
  REQ_PROFILE_POLICY_SET = 'REQ_PROFILE_POLICY_SET',
  RESP_PROFILE_POLICY_SET = 'RESP_PROFILE_POLICY_SET',
}

// =============================================================================
// BASE MESSAGE INTERFACE
// =============================================================================

export interface WsMessage {
  type: WsMessageType;
  wsRequestId?: string;
}

// =============================================================================
// REQUEST PAYLOADS
// =============================================================================

export interface WsReqConnectDirectory extends WsMessage {
  type: WsMessageType.REQ_CONNECT_DIRECTORY;
  username: string;
  password: string;
  zonePath?: string;
}

export interface WsReqLoginWorld extends WsMessage {
  type: WsMessageType.REQ_LOGIN_WORLD;
  username: string;
  password: string;
  worldName: string;
}

export interface WsReqRdoDirect extends WsMessage {
  type: WsMessageType.REQ_RDO_DIRECT;
  verb: RdoVerb;
  targetId: string;
  action?: RdoAction;
  member?: string;
  args?: string[];
}

export interface WsReqMapLoad extends WsMessage {
  type: WsMessageType.REQ_MAP_LOAD;
  x: number;
  y: number;
  width: number;
  height: number;
}

export interface WsReqManageConstruction extends WsMessage {
  type: WsMessageType.REQ_MANAGE_CONSTRUCTION;
  x: number;
  y: number;
  action: 'START' | 'STOP' | 'DOWN';
  count?: number;
}

export interface WsReqSelectCompany extends WsMessage {
  type: WsMessageType.REQ_SELECT_COMPANY;
  companyId: string;
}

export interface WsReqSwitchCompany extends WsMessage {
  type: WsMessageType.REQ_SWITCH_COMPANY;
  company: CompanyInfo;
}

// =============================================================================
// RESPONSE PAYLOADS
// =============================================================================

export interface WsRespError extends WsMessage {
  type: WsMessageType.RESP_ERROR;
  errorMessage: string;
  code: number;
}

export interface WsRespConnectSuccess extends WsMessage {
  type: WsMessageType.RESP_CONNECT_SUCCESS;
  worlds: WorldInfo[];
}

export interface WsRespLoginSuccess extends WsMessage {
  type: WsMessageType.RESP_LOGIN_SUCCESS;
  tycoonId: string;
  contextId: string;
  companyCount: number;
  companies?: CompanyInfo[];
}

export interface WsRespRdoResult extends WsMessage {
  type: WsMessageType.RESP_RDO_RESULT;
  result: string | string[];
}

export interface WsRespConstructionSuccess extends WsMessage {
  type: WsMessageType.RESP_CONSTRUCTION_SUCCESS;
  action: string;
  x: number;
  y: number;
}

export interface WsRespMapData extends WsMessage {
  type: WsMessageType.RESP_MAP_DATA;
  data: MapData;
}

// =============================================================================
// EVENT PAYLOADS
// =============================================================================

export interface WsEventChatMsg extends WsMessage {
  type: WsMessageType.EVENT_CHAT_MSG;
  channel: string;
  from: string;
  message: string;
}

export interface WsEventTycoonUpdate extends WsMessage {
  type: WsMessageType.EVENT_TYCOON_UPDATE;
  cash: string;
  incomePerHour: string;
  ranking: number;
  buildingCount: number;
  maxBuildings: number;
}

export interface WsEventRdoPush extends WsMessage {
  type: WsMessageType.EVENT_RDO_PUSH;
  rawPacket: string;
}

// =============================================================================
// CHAT MESSAGES
// =============================================================================

export interface WsReqChatGetUsers extends WsMessage {
  type: WsMessageType.REQ_CHAT_GET_USERS;
}

export interface WsReqChatGetChannels extends WsMessage {
  type: WsMessageType.REQ_CHAT_GET_CHANNELS;
}

export interface WsReqChatGetChannelInfo extends WsMessage {
  type: WsMessageType.REQ_CHAT_GET_CHANNEL_INFO;
  channelName: string;
}

export interface WsReqChatJoinChannel extends WsMessage {
  type: WsMessageType.REQ_CHAT_JOIN_CHANNEL;
  channelName: string;
}

export interface WsReqChatSendMessage extends WsMessage {
  type: WsMessageType.REQ_CHAT_SEND_MESSAGE;
  message: string;
}

export interface WsReqChatTypingStatus extends WsMessage {
  type: WsMessageType.REQ_CHAT_TYPING_STATUS;
  isTyping: boolean;
}

export interface WsRespChatUserList extends WsMessage {
  type: WsMessageType.RESP_CHAT_USER_LIST;
  users: ChatUser[];
}

export interface WsRespChatChannelList extends WsMessage {
  type: WsMessageType.RESP_CHAT_CHANNEL_LIST;
  channels: string[];
}

export interface WsRespChatChannelInfo extends WsMessage {
  type: WsMessageType.RESP_CHAT_CHANNEL_INFO;
  info: string;
}

export interface WsRespChatSuccess extends WsMessage {
  type: WsMessageType.RESP_CHAT_SUCCESS;
}

export interface WsEventChatUserTyping extends WsMessage {
  type: WsMessageType.EVENT_CHAT_USER_TYPING;
  username: string;
  isTyping: boolean;
}

export interface WsEventChatChannelChange extends WsMessage {
  type: WsMessageType.EVENT_CHAT_CHANNEL_CHANGE;
  channelName: string;
}

export interface WsEventChatUserListChange extends WsMessage {
  type: WsMessageType.EVENT_CHAT_USER_LIST_CHANGE;
  user: ChatUser;
  action: 'JOIN' | 'LEAVE';
}

// =============================================================================
// BUILDING FOCUS MESSAGES
// =============================================================================

export interface WsReqBuildingFocus extends WsMessage {
  type: WsMessageType.REQ_BUILDING_FOCUS;
  x: number;
  y: number;
}

export interface WsReqBuildingUnfocus extends WsMessage {
  type: WsMessageType.REQ_BUILDING_UNFOCUS;
}

export interface WsRespBuildingFocus extends WsMessage {
  type: WsMessageType.RESP_BUILDING_FOCUS;
  building: BuildingFocusInfo;
}

export interface WsEventBuildingRefresh extends WsMessage {
  type: WsMessageType.EVENT_BUILDING_REFRESH;
  building: BuildingFocusInfo;
}

// =============================================================================
// BUILDING CONSTRUCTION MESSAGES
// =============================================================================

export interface WsReqGetBuildingCategories extends WsMessage {
  type: WsMessageType.REQ_GET_BUILDING_CATEGORIES;
  companyName: string;
}

export interface WsReqGetBuildingFacilities extends WsMessage {
  type: WsMessageType.REQ_GET_BUILDING_FACILITIES;
  companyName: string;
  cluster: string;
  kind: string;
  kindName: string;
  folder: string;
  tycoonLevel: number;
}

export interface WsReqPlaceBuilding extends WsMessage {
  type: WsMessageType.REQ_PLACE_BUILDING;
  facilityClass: string;
  x: number;
  y: number;
}

export interface WsReqGetSurface extends WsMessage {
  type: WsMessageType.REQ_GET_SURFACE;
  surfaceType: SurfaceType;
  x1: number;
  y1: number;
  x2: number;
  y2: number;
}

export interface WsReqGetAllFacilityDimensions extends WsMessage {
  type: WsMessageType.REQ_GET_ALL_FACILITY_DIMENSIONS;
}

export interface WsRespBuildingCategories extends WsMessage {
  type: WsMessageType.RESP_BUILDING_CATEGORIES;
  categories: BuildingCategory[];
}

export interface WsRespBuildingFacilities extends WsMessage {
  type: WsMessageType.RESP_BUILDING_FACILITIES;
  facilities: BuildingInfo[];
}

export interface WsRespBuildingPlaced extends WsMessage {
  type: WsMessageType.RESP_BUILDING_PLACED;
  x: number;
  y: number;
  buildingId: string;
}

export interface WsRespSurfaceData extends WsMessage {
  type: WsMessageType.RESP_SURFACE_DATA;
  data: SurfaceData;
}

export interface WsRespAllFacilityDimensions extends WsMessage {
  type: WsMessageType.RESP_ALL_FACILITY_DIMENSIONS;
  dimensions: Record<string, FacilityDimensions>;
}

// =============================================================================
// BUILDING DETAILS MESSAGES
// =============================================================================

export interface WsReqBuildingDetails extends WsMessage {
  type: WsMessageType.REQ_BUILDING_DETAILS;
  x: number;
  y: number;
  visualClass: string;
}

export interface WsRespBuildingDetails extends WsMessage {
  type: WsMessageType.RESP_BUILDING_DETAILS;
  details: BuildingDetailsResponse;
}

export interface WsReqBuildingSetProperty extends WsMessage {
  type: WsMessageType.REQ_BUILDING_SET_PROPERTY;
  x: number;
  y: number;
  propertyName: string;
  value: string;
  additionalParams?: Record<string, string>;
}

export interface WsRespBuildingSetProperty extends WsMessage {
  type: WsMessageType.RESP_BUILDING_SET_PROPERTY;
  success: boolean;
  propertyName: string;
  newValue: string;
}

export interface WsReqBuildingUpgrade extends WsMessage {
  type: WsMessageType.REQ_BUILDING_UPGRADE;
  x: number;
  y: number;
  action: 'DOWNGRADE' | 'START_UPGRADE' | 'STOP_UPGRADE';
  count?: number;
}

export interface WsRespBuildingUpgrade extends WsMessage {
  type: WsMessageType.RESP_BUILDING_UPGRADE;
  success: boolean;
  action: 'DOWNGRADE' | 'START_UPGRADE' | 'STOP_UPGRADE';
  message?: string;
}

export interface WsReqRenameFacility extends WsMessage {
  type: WsMessageType.REQ_RENAME_FACILITY;
  x: number;
  y: number;
  newName: string;
}

export interface WsRespRenameFacility extends WsMessage {
  type: WsMessageType.RESP_RENAME_FACILITY;
  success: boolean;
  newName: string;
  message?: string;
}

export interface WsReqDeleteFacility extends WsMessage {
  type: WsMessageType.REQ_DELETE_FACILITY;
  x: number;
  y: number;
}

export interface WsRespDeleteFacility extends WsMessage {
  type: WsMessageType.RESP_DELETE_FACILITY;
  success: boolean;
  message?: string;
}

// =============================================================================
// SEARCH MENU MESSAGES
// =============================================================================

export interface WsReqSearchMenuHome extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_HOME;
}

export interface WsRespSearchMenuHome extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_HOME;
  categories: SearchMenuCategory[];
}

export interface WsReqSearchMenuTowns extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_TOWNS;
}

export interface WsRespSearchMenuTowns extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_TOWNS;
  towns: TownInfo[];
}

export interface WsReqSearchMenuTycoonProfile extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_TYCOON_PROFILE;
  tycoonName: string;
}

export interface WsRespSearchMenuTycoonProfile extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_TYCOON_PROFILE;
  profile: TycoonProfile;
}

export interface WsReqSearchMenuPeople extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_PEOPLE;
}

export interface WsRespSearchMenuPeople extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_PEOPLE;
}

export interface WsReqSearchMenuPeopleSearch extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_PEOPLE_SEARCH;
  searchStr: string;
}

export interface WsRespSearchMenuPeopleSearch extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_PEOPLE_SEARCH;
  results: string[];
}

export interface WsReqSearchMenuRankings extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_RANKINGS;
}

export interface WsRespSearchMenuRankings extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_RANKINGS;
  categories: RankingCategory[];
}

export interface WsReqSearchMenuRankingDetail extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_RANKING_DETAIL;
  rankingPath: string;
}

export interface WsRespSearchMenuRankingDetail extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_RANKING_DETAIL;
  title: string;
  entries: RankingEntry[];
}

export interface WsReqSearchMenuBanks extends WsMessage {
  type: WsMessageType.REQ_SEARCH_MENU_BANKS;
}

export interface WsRespSearchMenuBanks extends WsMessage {
  type: WsMessageType.RESP_SEARCH_MENU_BANKS;
  banks: unknown[];
}

// =============================================================================
// ROAD BUILDING MESSAGES
// =============================================================================

export interface WsReqBuildRoad extends WsMessage {
  type: WsMessageType.REQ_BUILD_ROAD;
  x1: number;
  y1: number;
  x2: number;
  y2: number;
}

export interface WsRespBuildRoad extends WsMessage {
  type: WsMessageType.RESP_BUILD_ROAD;
  success: boolean;
  cost: number;
  tileCount: number;
  message?: string;
  errorCode?: number;
}

export interface WsReqGetRoadCost extends WsMessage {
  type: WsMessageType.REQ_GET_ROAD_COST;
  x1: number;
  y1: number;
  x2: number;
  y2: number;
}

export interface WsRespGetRoadCost extends WsMessage {
  type: WsMessageType.RESP_GET_ROAD_COST;
  cost: number;
  tileCount: number;
  costPerTile: number;
}

// =============================================================================
// LOGOUT MESSAGES
// =============================================================================

export interface WsReqLogout extends WsMessage {
  type: WsMessageType.REQ_LOGOUT;
}

export interface WsRespLogout extends WsMessage {
  type: WsMessageType.RESP_LOGOUT;
  success: boolean;
  message?: string;
}

// =============================================================================
// MAIL MESSAGES
// =============================================================================

export interface WsReqMailConnect extends WsMessage {
  type: WsMessageType.REQ_MAIL_CONNECT;
}

export interface WsReqMailGetFolder extends WsMessage {
  type: WsMessageType.REQ_MAIL_GET_FOLDER;
  folder: MailFolder;
}

export interface WsReqMailReadMessage extends WsMessage {
  type: WsMessageType.REQ_MAIL_READ_MESSAGE;
  folder: MailFolder;
  messageId: string;
}

export interface WsReqMailCompose extends WsMessage {
  type: WsMessageType.REQ_MAIL_COMPOSE;
  to: string;         // Recipient address(es), semicolon-separated
  subject: string;
  body: string[];      // Lines of text
  headers?: string;    // Original message headers for reply/forward threading (AddHeaders)
}

export interface WsReqMailDelete extends WsMessage {
  type: WsMessageType.REQ_MAIL_DELETE;
  folder: MailFolder;
  messageId: string;
}

export interface WsReqMailGetUnreadCount extends WsMessage {
  type: WsMessageType.REQ_MAIL_GET_UNREAD_COUNT;
}

export interface WsRespMailConnected extends WsMessage {
  type: WsMessageType.RESP_MAIL_CONNECTED;
  unreadCount: number;
}

export interface WsRespMailFolder extends WsMessage {
  type: WsMessageType.RESP_MAIL_FOLDER;
  folder: MailFolder;
  messages: MailMessageHeader[];
}

export interface WsRespMailMessage extends WsMessage {
  type: WsMessageType.RESP_MAIL_MESSAGE;
  message: MailMessageFull;
}

export interface WsRespMailSent extends WsMessage {
  type: WsMessageType.RESP_MAIL_SENT;
  success: boolean;
  message?: string;
}

export interface WsRespMailDeleted extends WsMessage {
  type: WsMessageType.RESP_MAIL_DELETED;
  success: boolean;
}

export interface WsRespMailUnreadCount extends WsMessage {
  type: WsMessageType.RESP_MAIL_UNREAD_COUNT;
  count: number;
}

export interface WsEventNewMail extends WsMessage {
  type: WsMessageType.EVENT_NEW_MAIL;
  unreadCount: number;
}

export interface WsReqMailSaveDraft extends WsMessage {
  type: WsMessageType.REQ_MAIL_SAVE_DRAFT;
  to: string;
  subject: string;
  body: string[];
  headers?: string;           // Original headers for reply/forward threading
  existingDraftId?: string;   // If editing existing draft, delete old one first
}

export interface WsRespMailDraftSaved extends WsMessage {
  type: WsMessageType.RESP_MAIL_DRAFT_SAVED;
  success: boolean;
  message?: string;
}

// =============================================================================
// PROFILE MESSAGES
// =============================================================================

export interface WsReqGetProfile extends WsMessage {
  type: WsMessageType.REQ_GET_PROFILE;
}

export interface WsRespGetProfile extends WsMessage {
  type: WsMessageType.RESP_GET_PROFILE;
  profile: TycoonProfileFull;
}

// =============================================================================
// PROFILE TAB MESSAGES
// =============================================================================

// --- Curriculum ---
export interface WsReqProfileCurriculum extends WsMessage {
  type: WsMessageType.REQ_PROFILE_CURRICULUM;
}

export interface WsRespProfileCurriculum extends WsMessage {
  type: WsMessageType.RESP_PROFILE_CURRICULUM;
  data: CurriculumData;
}

// --- Bank Account ---
export interface WsReqProfileBank extends WsMessage {
  type: WsMessageType.REQ_PROFILE_BANK;
}

export interface WsRespProfileBank extends WsMessage {
  type: WsMessageType.RESP_PROFILE_BANK;
  data: BankAccountData;
}

export interface WsReqProfileBankAction extends WsMessage {
  type: WsMessageType.REQ_PROFILE_BANK_ACTION;
  action: BankActionType;
  amount?: string;
  toTycoon?: string;
  reason?: string;
  loanIndex?: number;
}

export interface WsRespProfileBankAction extends WsMessage {
  type: WsMessageType.RESP_PROFILE_BANK_ACTION;
  result: BankActionResult;
}

// --- Profit & Loss ---
export interface WsReqProfileProfitLoss extends WsMessage {
  type: WsMessageType.REQ_PROFILE_PROFITLOSS;
}

export interface WsRespProfileProfitLoss extends WsMessage {
  type: WsMessageType.RESP_PROFILE_PROFITLOSS;
  data: ProfitLossData;
}

// --- Companies ---
export interface WsReqProfileCompanies extends WsMessage {
  type: WsMessageType.REQ_PROFILE_COMPANIES;
}

export interface WsRespProfileCompanies extends WsMessage {
  type: WsMessageType.RESP_PROFILE_COMPANIES;
  data: CompaniesData;
}

// --- Auto Connections ---
export interface WsReqProfileAutoConnections extends WsMessage {
  type: WsMessageType.REQ_PROFILE_AUTOCONNECTIONS;
}

export interface WsRespProfileAutoConnections extends WsMessage {
  type: WsMessageType.RESP_PROFILE_AUTOCONNECTIONS;
  data: AutoConnectionsData;
}

export interface WsReqProfileAutoConnectionAction extends WsMessage {
  type: WsMessageType.REQ_PROFILE_AUTOCONNECTION_ACTION;
  action: AutoConnectionActionType;
  fluidId: string;
  suppliers?: string;
}

export interface WsRespProfileAutoConnectionAction extends WsMessage {
  type: WsMessageType.RESP_PROFILE_AUTOCONNECTION_ACTION;
  success: boolean;
  message?: string;
}

// --- Policy ---
export interface WsReqProfilePolicy extends WsMessage {
  type: WsMessageType.REQ_PROFILE_POLICY;
}

export interface WsRespProfilePolicy extends WsMessage {
  type: WsMessageType.RESP_PROFILE_POLICY;
  data: PolicyData;
}

export interface WsReqProfilePolicySet extends WsMessage {
  type: WsMessageType.REQ_PROFILE_POLICY_SET;
  tycoonName: string;
  status: number;
}

export interface WsRespProfilePolicySet extends WsMessage {
  type: WsMessageType.RESP_PROFILE_POLICY_SET;
  success: boolean;
  message?: string;
}

// =============================================================================
// TYPE GUARDS
// =============================================================================

export function isWsRequest(msg: WsMessage): boolean {
  return msg.type.startsWith('REQ_');
}
